<?xml version="1.0" encoding="utf-8"?>
<PreferenceScreen xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:app="http://schemas.android.com/apk/res-auto">

    <!-- Display Mode should be at the root level, not nested inside Photo Sources -->
    <PreferenceCategory
        android:title="Display Mode"
        android:key="display_mode">

        <ListPreference
            android:key="display_mode_selection"
            android:title="Select Display Mode"
            android:summary="Choose how photos are displayed"
            android:defaultValue="dream_service"
            android:entries="@array/display_mode_entries"
            android:entryValues="@array/display_mode_values"/>
    </PreferenceCategory>

    <!-- Lock Screen Settings should be at the root level -->
    <PreferenceCategory
        android:key="lock_screen_settings"
        android:title="Lock Screen Settings"
        android:dependency="display_mode_selection">

        <SwitchPreferenceCompat
            android:key="lock_screen_clock"
            android:title="Show Clock"
            android:summary="Display time on lock screen"
            android:defaultValue="true" />

        <SwitchPreferenceCompat
            android:key="lock_screen_date"
            android:summary="Display date on lock screen"
            android:title="Show Date"
            android:defaultValue="true" />

        <ListPreference
            android:key="lock_screen_transition"
            android:title="Photo Transition"
            android:summary="Choose how photos change"
            android:entries="@array/transition_entries"
            android:entryValues="@array/transition_values"
            android:defaultValue="fade" />

        <SeekBarPreference
            android:key="lock_screen_interval"
            android:title="Photo Change Interval"
            android:summary="Time between photo changes"
            android:max="60"
            android:min="5"
            android:defaultValue="10" />

        <Preference
            android:key="preview_lock_screen"
            android:title="Preview Lock Screen"
            android:summary="See how your lock screen will look" />

        <Preference
            android:key="lock_screen_status"
            android:title="Lock Screen Status"
            android:selectable="false" />
    </PreferenceCategory>

    <PreferenceCategory
        android:title="Photo Sources"
        android:key="photo_sources">
        <!-- Photo source preferences unchanged -->
    </PreferenceCategory>

    <PreferenceCategory
        android:title="Screensaver Settings"
        android:key="screensaver_settings">
        <!-- Screensaver settings unchanged -->
    </PreferenceCategory>

    <PreferenceCategory
        android:title="Display Settings"
        android:key="display_settings">
        <!-- Display settings unchanged -->
    </PreferenceCategory>

    <PreferenceCategory
        android:title="Schedule"
        android:key="schedule_settings">
        <!-- Schedule settings unchanged -->
    </PreferenceCategory>

    <PreferenceCategory
        android:title="Debug Options"
        android:key="debug_settings">
        <Preference
            android:key="test_screensaver"
            android:title="Test Screensaver"
            android:summary="Start the screensaver manually"/>
    </PreferenceCategory>

</PreferenceScreen>